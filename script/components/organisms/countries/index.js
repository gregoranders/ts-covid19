import e,{memo as o}from"react";import{useRecoilState as v}from"recoil";import{Link as C}from"react-router-dom";import D from"states/sort";import _ from"components/atoms/sortableTh";import{ModelArrayPropTypes as A,nameFormatter as I,numberFormatter as O,urlFormatter as V,timeFormatter as M}from"model";import P,{Sort as U}from"model/sorter";const j=new P;export const Countries=({models:t})=>{const[a,r]=v(D);j.by=a;const l=e=>{r(a===e?a%2==0?e-1:e+1:e)};j.idx=t[0].values.length-1;const c=t.map(e=>({population:e.population,confirmed:e.values[j.idx].confirmed,dead:e.values[j.idx].dead,recovered:e.values[j.idx].recovered,active:e.values[j.idx].active,diff:{confirmed:e.values[j.idx].diff.confirmed,dead:e.values[j.idx].diff.dead,recovered:e.values[j.idx].diff.recovered,active:e.values[j.idx].diff.active},ratio:{confirmed:e.values[j.idx].ratio.confirmed,dead:e.values[j.idx].ratio.dead,recovered:e.values[j.idx].ratio.recovered,active:e.values[j.idx].ratio.active}})).reduce((e,t)=>({population:e.population+t.population,confirmed:e.confirmed+t.confirmed,dead:e.dead+t.dead,recovered:e.recovered+t.recovered,active:e.active+t.active,diff:{confirmed:e.diff.confirmed+t.diff.confirmed,dead:e.diff.dead+t.diff.dead,recovered:e.diff.recovered+t.diff.recovered,active:e.diff.active+t.diff.active},ratio:{confirmed:e.ratio.confirmed+t.ratio.confirmed,dead:e.ratio.dead+t.ratio.dead,recovered:e.ratio.recovered+t.ratio.recovered,active:e.ratio.active+t.ratio.active}})),i=(t[0].values[j.idx].timestamp-t[0].values[0].timestamp)/864e5;return e.createElement(e.Fragment,null,e.createElement("table",{className:"w3-table-all w3-hoverable countries"},e.createElement("thead",null,e.createElement("tr",{className:"w3-black"},e.createElement("th",null),e.createElement("th",null,M(t[0].values[0].timestamp)," - ",M(t[0].values[j.idx].timestamp)),e.createElement("th",null),e.createElement("th",{className:"w3-center",colSpan:3},"Confirmed"),e.createElement("th",{className:"w3-center",colSpan:3},"Dead"),e.createElement("th",{className:"w3-center",colSpan:3},"Recovered"),e.createElement("th",{className:"w3-center",colSpan:3},"Active")),e.createElement("tr",{className:"w3-black"},e.createElement("th",null),e.createElement(_,{alpha:!0,by:a,asc:U.NAME_ASC,desc:U.NAME_DESC,sort:l},"Country/Region"),e.createElement(_,{by:a,asc:U.POPULATION_ASC,desc:U.POPULATION_DESC,sort:l},"Population"),e.createElement(_,{by:a,asc:U.CONFIRMED_ASC,desc:U.CONFIRMED_DESC,sort:l},"Total"),e.createElement(_,{by:a,asc:U.CONFIRMED_RATIO_ASC,desc:U.CONFIRMED_RATIO_DESC,sort:l},"/100k"),e.createElement(_,{by:a,asc:U.CONFIRMED_DIFF_ASC,desc:U.CONFIRMED_DIFF_DESC,sort:l},"Daily"),e.createElement(_,{by:a,asc:U.DEAD_ASC,desc:U.DEAD_DESC,sort:l},"Total"),e.createElement(_,{by:a,asc:U.DEAD_RATIO_ASC,desc:U.DEAD_RATIO_DESC,sort:l},"/100k"),e.createElement(_,{by:a,asc:U.DEAD_DIFF_ASC,desc:U.DEAD_DIFF_DESC,sort:l},"Daily"),e.createElement(_,{by:a,asc:U.RECOVERED_ASC,desc:U.RECOVERED_DESC,sort:l},"Total"),e.createElement(_,{by:a,asc:U.RECOVERED_RATIO_ASC,desc:U.RECOVERED_RATIO_DESC,sort:l},"/100k"),e.createElement(_,{by:a,asc:U.RECOVERED_DIFF_ASC,desc:U.RECOVERED_DIFF_DESC,sort:l},"Daily"),e.createElement(_,{by:a,asc:U.ACTIVE_ASC,desc:U.ACTIVE_DESC,sort:l},"Total"),e.createElement(_,{by:a,asc:U.ACTIVE_RATIO_ASC,desc:U.ACTIVE_RATIO_DESC,sort:l},"/100k"),e.createElement(_,{by:a,asc:U.ACTIVE_DIFF_ASC,desc:U.ACTIVE_DIFF_DESC,sort:l},"Daily"))),e.createElement("tbody",null,[...t].sort(j.sort).slice(0).map((t,a)=>{const r=t.values[j.idx];return e.createElement("tr",{key:a},e.createElement("td",{className:"w3-right-align"},a+1),e.createElement("td",null,e.createElement(C,{to:V(t)},I(t))),e.createElement("td",{className:"w3-right-align"},O(t.population)),e.createElement("td",{className:"w3-right-align"},O(r.confirmed)),e.createElement("td",{className:"w3-right-align"},O(r.ratio.confirmed)),e.createElement("td",{className:"w3-right-align"},O(r.diff.confirmed)),e.createElement("td",{className:"w3-right-align"},O(r.dead)),e.createElement("td",{className:"w3-right-align"},O(r.ratio.dead)),e.createElement("td",{className:"w3-right-align"},O(r.diff.dead)),e.createElement("td",{className:"w3-right-align"},O(r.recovered)),e.createElement("td",{className:"w3-right-align"},O(r.ratio.recovered)),e.createElement("td",{className:"w3-right-align"},O(r.diff.recovered)),e.createElement("td",{className:"w3-right-align"},O(r.active)),e.createElement("td",{className:"w3-right-align"},O(r.ratio.active)),e.createElement("td",{className:"w3-right-align"},O(r.diff.active)))})),e.createElement("tfoot",null,e.createElement("tr",{className:"w3-black"},e.createElement("th",null),e.createElement("th",null,O(i+1)," days [",((i+1)/30).toFixed(1)," months]"),e.createElement("th",null,O(c.population)),e.createElement("th",null,O(c.confirmed)),e.createElement("th",null,O(c.ratio.confirmed)),e.createElement("th",null,O(c.diff.confirmed)),e.createElement("th",null,O(c.dead)),e.createElement("th",null,O(c.ratio.dead)),e.createElement("th",null,O(c.diff.dead)),e.createElement("th",null,O(c.recovered)),e.createElement("th",null,O(c.ratio.recovered)),e.createElement("th",null,O(c.diff.recovered)),e.createElement("th",null,O(c.active)),e.createElement("th",null,O(c.ratio.active)),e.createElement("th",null,O(c.diff.active))))))};Countries.displayName="Countries",Countries.propTypes={models:A};export default o(Countries);