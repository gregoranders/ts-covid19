import v,{memo as C}from"react";import{useRecoilState as D}from"recoil";import{Link as _}from"react-router-dom";import S from"loading";import I from"states/sort";import{ModelArrayPropTypes as R,nameFormatter as A,numberFormatter as T,urlFormatter as F,timeFormatter as O}from"model";import N,{Sort as V}from"model/sorter";const M=new N;export const Countries=({models:e})=>{const[t,l]=D(I);M.by=t;const r=e=>{l(t===e?t%2==0?e-1:e+1:e)};if(!e.length)return v.createElement(S,null);M.idx=e[0].values.length-1;const a=e.map(e=>({population:e.population,confirmed:e.values[M.idx].confirmed,dead:e.values[M.idx].dead,recovered:e.values[M.idx].recovered,active:e.values[M.idx].active,diff:{confirmed:e.values[M.idx].diff.confirmed,dead:e.values[M.idx].diff.dead,recovered:e.values[M.idx].diff.recovered,active:e.values[M.idx].diff.active},ratio:{confirmed:e.values[M.idx].ratio.confirmed,dead:e.values[M.idx].ratio.dead,recovered:e.values[M.idx].ratio.recovered,active:e.values[M.idx].ratio.active}})).reduce((e,t)=>({population:e.population+t.population,confirmed:e.confirmed+t.confirmed,dead:e.dead+t.dead,recovered:e.recovered+t.recovered,active:e.active+t.active,diff:{confirmed:e.diff.confirmed+t.diff.confirmed,dead:e.diff.dead+t.diff.dead,recovered:e.diff.recovered+t.diff.recovered,active:e.diff.active+t.diff.active},ratio:{confirmed:e.ratio.confirmed+t.ratio.confirmed,dead:e.ratio.dead+t.ratio.dead,recovered:e.ratio.recovered+t.ratio.recovered,active:e.ratio.active+t.ratio.active}})),n=(e[0].values[M.idx].timestamp-e[0].values[0].timestamp)/864e5;return v.createElement("table",{className:"countries"},v.createElement("thead",null,v.createElement("tr",null,v.createElement("th",null),v.createElement("th",null,O(e[0].values[0].timestamp)," - ",O(e[0].values[M.idx].timestamp)),v.createElement("th",null),v.createElement("th",{colSpan:3},"Confirmed"),v.createElement("th",{colSpan:3},"Dead"),v.createElement("th",{colSpan:3},"Recovered"),v.createElement("th",{colSpan:3},"Active")),v.createElement("tr",null,v.createElement("th",null),v.createElement("th",{onClick:()=>r(V.NAME_ASC)},"Country/Region"),v.createElement("th",{onClick:()=>r(V.POPULATION_DESC)},"Population"),v.createElement("th",{onClick:()=>r(V.CONFIRMED_DESC)},"Total"),v.createElement("th",{onClick:()=>r(V.CONFIRMED_RATIO_DESC)},"/100k"),v.createElement("th",{onClick:()=>r(V.CONFIRMED_DIFF_DESC)},"Daily"),v.createElement("th",{onClick:()=>r(V.DEAD_DESC)},"Total"),v.createElement("th",{onClick:()=>r(V.DEAD_RATIO_DESC)},"/100k"),v.createElement("th",{onClick:()=>r(V.DEAD_DIFF_DESC)},"Daily"),v.createElement("th",{onClick:()=>r(V.RECOVERED_DESC)},"Total"),v.createElement("th",{onClick:()=>r(V.RECOVERED_RATIO_DESC)},"/100k"),v.createElement("th",{onClick:()=>r(V.RECOVERED_DIFF_DESC)},"Daily"),v.createElement("th",{onClick:()=>r(V.ACTIVE_DESC)},"Total"),v.createElement("th",{onClick:()=>r(V.ACTIVE_RATIO_DESC)},"/100k"),v.createElement("th",{onClick:()=>r(V.ACTIVE_DIFF_DESC)},"Daily"))),v.createElement("tbody",null,[...e].sort(M.sort).slice(0).map((e,t)=>{const l=e.values[M.idx];return v.createElement("tr",{key:t},v.createElement("td",null,t+1),v.createElement("td",null,v.createElement(_,{to:F(e)},A(e))),v.createElement("td",null,T(e.population)),v.createElement("td",null,T(l.confirmed)),v.createElement("td",null,T(l.ratio.confirmed)),v.createElement("td",null,T(l.diff.confirmed)),v.createElement("td",null,T(l.dead)),v.createElement("td",null,T(l.ratio.dead)),v.createElement("td",null,T(l.diff.dead)),v.createElement("td",null,T(l.recovered)),v.createElement("td",null,T(l.ratio.recovered)),v.createElement("td",null,T(l.diff.recovered)),v.createElement("td",null,T(l.active)),v.createElement("td",null,T(l.ratio.active)),v.createElement("td",null,T(l.diff.active)))})),v.createElement("tfoot",null,v.createElement("tr",null,v.createElement("th",null),v.createElement("th",null,T(n+1)," days [",((n+1)/30).toFixed(1)," months]"),v.createElement("th",null,T(a.population)),v.createElement("th",null,T(a.confirmed)),v.createElement("th",null,T(a.ratio.confirmed)),v.createElement("th",null,T(a.diff.confirmed)),v.createElement("th",null,T(a.dead)),v.createElement("th",null,T(a.ratio.dead)),v.createElement("th",null,T(a.diff.dead)),v.createElement("th",null,T(a.recovered)),v.createElement("th",null,T(a.ratio.recovered)),v.createElement("th",null,T(a.diff.recovered)),v.createElement("th",null,T(a.active)),v.createElement("th",null,T(a.ratio.active)),v.createElement("th",null,T(a.diff.active)))))};Countries.displayName="Countries",Countries.propTypes={models:R};export default C(Countries);