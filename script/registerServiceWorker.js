export const registerServiceWorker=(e="/")=>new Promise((r,t)=>{if(navigator.serviceWorker){if(new URL(window.location.toString()).origin!==window.location.origin)return;r(((e,r)=>new Promise((t,i)=>{fetch(e).then(i=>{404===i.status||-1===i.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(e=>{e.unregister().then(()=>{window.location.reload()})}):t(((e,r)=>new Promise((t,i)=>{navigator.serviceWorker.register(e,{scope:r,type:"classic"}).then(e=>{e.installing?t(e.installing):e.active&&t(e.active),e.onupdatefound=()=>{const r=e.installing;r&&(r.onerror=console.error,r.onstatechange=()=>{"installed"===r.state?navigator.serviceWorker.controller?r.postMessage({type:"CONTENT_UPDATED"}):r.postMessage({type:"CONTENT_CACHED"}):"activated"===r.state&&r.postMessage({type:"CLIENTS_CLAIM"})})}}).catch(i)}))(e,r))}).catch(i)}))((e=>e&&e.length&&"/"!==e?`${e}serviceWorker.js?base=${e}`:"serviceWorker.js")(e),e))}else t(new Error("Missing navigator.serviceWorker"))});export const unregister=()=>new Promise((e,r)=>{navigator.serviceWorker?navigator.serviceWorker.ready.then(r=>{e(r.unregister())}):r(new Error("Missing navigator.serviceWorker"))});export default registerServiceWorker;