const $=(e,r)=>new Promise((t,o)=>{fetch(e).then(o=>{404===o.status||-1===o.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(e=>{e.unregister().then(()=>{window.location.reload()})}):t(((e,r)=>new Promise((t,o)=>{navigator.serviceWorker.register(e,{scope:r,type:"classic"}).then(e=>{e.onupdatefound=()=>{const r=e.installing;r&&(r.onerror=console.error,r.onstatechange=()=>{"installed"===r.state?navigator.serviceWorker.controller?r.postMessage({type:"CONTENT_UPDATED"}):r.postMessage({type:"CONTENT_CACHED"}):"activated"===r.state&&r.postMessage({type:"CLIENTS_CLAIM"})})},e.installing?t(e.installing):e.active&&t(e.active)}).catch(o)}))(e,r))}).catch(o)});export const registerServiceWorker=(e="/")=>new Promise((r,t)=>{if(navigator.serviceWorker){if(new URL(window.location.toString()).origin!==window.location.origin)return;const t=(e=>e&&e.length&&"/"!==e?`${e}serviceWorker.js?base=${e}`:"serviceWorker.js")(e);r($(t,e))}else t(new Error("Missing navigator.serviceWorker"))});export const unregister=()=>new Promise((e,r)=>{navigator.serviceWorker?navigator.serviceWorker.ready.then(r=>{e(r.unregister())}):r(new Error("Missing navigator.serviceWorker"))});export default registerServiceWorker;