import ie from"prop-types";import{atom as ce,selector as me}from"recoil";import{ModelArrayPropTypes as I}from"states/model/model";import{ModelCollector as pe}from"states/model/collector";import{ModelProcessor as de}from"states/model/processor";export const nameFormatter=e=>e.state&&e.state.length?`${e.country} - ${e.state}`:e.country;export const urlFormatter=e=>e.state&&e.state.length?`${e.country}/${e.state}`:e.country;export const numberFormatter=e=>Number.isInteger(e)?e.toLocaleString():Math.round(e).toLocaleString();export const timeFormatter=e=>new Date(e).toUTCString().replace(/\s00:.*/,"");export const modelFind=(e,t,o)=>e.find(e=>o?!!e.state&&e.country===t&&e.state===o:e.country===t);export const State=ce({key:"modelState",default:[]});export const Selector=me({key:"modelStateSelector",get:()=>new Promise((e,t)=>{const o=()=>{(new pe).collect().then(t=>{const o=new de(t);setTimeout(()=>{const t=o.model;ie.checkPropTypes(I,t,"get","Selector"),ie.resetWarningCache(),e(t)},1)}).catch(t)};navigator.serviceWorker&&navigator.serviceWorker.controller?navigator.serviceWorker.ready.then(t=>{t.sync.register("UPDATE_MODEL").then(()=>{navigator.serviceWorker.onmessage=t=>{ie.checkPropTypes(I,t.data,"get","Selector"),ie.resetWarningCache(),e(t.data)}}).catch(()=>{o()})}):o()})});export default State;